---
import { Sun, Moon } from 'lucide-react';
---

<button
  id="theme-toggle"
  type="button"
  class="inline-flex items-center justify-center rounded-md p-2.5 text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500 dark:text-gray-400 dark:hover:bg-gray-800 dark:focus:ring-primary-400"
  aria-label="Toggle theme"
>
  <Sun className="hidden h-5 w-5 dark:block" />
  <Moon className="h-5 w-5 dark:hidden" />
</button>

<script>
  const themeToggle = document.getElementById('theme-toggle');
  
  function updateTheme(isDark) {
    document.documentElement.classList.toggle('dark', isDark);
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  }

  // Inicializar tema
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const storedTheme = localStorage.getItem('theme');
  const isDark = storedTheme ? storedTheme === 'dark' : prefersDark;
  updateTheme(isDark);

  // Toggle do tema
  themeToggle?.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    updateTheme(!isDark);
  });

  // Observar mudanças nas preferências do sistema
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
    if (!localStorage.getItem('theme')) {
      updateTheme(e.matches);
    }
  });
</script>